### 2025-12-02 (Ver 4.6)
- **To:** DGFS PM
- **작업 목표:** 조작감과 타격감을 높이기 위한 효과음(SFX) 시스템 구현 및 안정화 (Phase 4.6)
- **주요 변경사항:**
  1.  **[Feature] 데이터 기반 동적 효과음 시스템 구축:**
      - **`AudioManager` 확장 (`ui/audio_manager.py`):** 효과음 재생을 전담하는 `play_sfx` 메소드를 구현했습니다. 이 메소드는 사운드 객체를 재사용하는 캐싱(Caching) 기능과 사운드 파일이 없을 때 게임이 멈추지 않도록 하는 예외 처리 로직을 포함합니다.
      - **데이터 모델 확장 (`fighter_data.py`, `database.py`):** 캐릭터의 공격 사운드 타입을 결정하는 `sfx_type` 필드를 `characters.csv`와 DB 스키마, `FighterData` 클래스에 모두 추가했습니다.
      - **전투 로직 연동 (`battle_system.py`, `battle_view.py`):** 전투 중 공격/스킬/필살기 사용 시, 공격자의 `sfx_type`에 따라 '검격음' 또는 '타격음' 계열의 다른 효과음이 재생되도록 핵심 분기 로직을 구현했습니다.

  2.  **[Feature] UI/연출 효과음 연동:**
      - **UI 효과음 (`ui/components.py`):** 모든 버튼 클릭 시 `ui_click.wav` 효과음이 재생되도록 연동했습니다.
      - **뽑기 연출 (`scenes/gacha_scene.py`):** 1회/10회 소환 결과 화면 진입 시, 각각 다른 전용 효과음이 재생되도록 구현했습니다.

  3.  **[Feature] 사운드 제어 기능 추가:**
      - **음소거 로직 (`ui/audio_manager.py`):** BGM과 SFX의 음소거 상태를 관리하는 `bgm_muted`, `sfx_muted` 변수와 이를 제어하는 `toggle_bgm()`, `toggle_sfx()` 메소드를 추가했습니다.
      - **UI 연동 (`ui/battle_view.py`):** 전투 화면 우측 상단에 BGM과 SFX를 각각 켜고 끌 수 있는 토글 버튼을 추가하여, 플레이어가 사운드를 직접 제어할 수 있도록 편의성을 개선했습니다.

  4.  **[UX] 타격감 강화:**
      - **볼륨 차등 적용 (`ui/battle_view.py`):** 공격(0.8), 스킬(1.0), 필살기(1.2)의 볼륨을 다르게 설정하여, 행동의 강약에 따라 사운드 피드백이 명확히 구분되도록 타격감을 강화했습니다.

  5.  **[Bug Fix] 시스템 안정화 및 데이터 정합성 확보:**
      - **전투 데이터 누락:** 전투 시작 시 `sfx_type` 등 신규 데이터가 로드되지 않아 모든 공격음이 동일하게 나오던 문제를 `battle_data_handler.py`와 `battle_scene.py`를 수정하여 해결했습니다.
      - **DB 스키마 불일치:** `database.py`의 테이블 생성 구문에 신규 컬럼이 누락되어 게임이 시작되지 않던 문제를 수정했습니다.
      - **덱 뷰(Deck View) 오류:** `skill_description` 컬럼 부재로 인해 '내 덱 보기' 화면 진입 시 발생하던 오류를 `deck_scene.py`의 SQL 쿼리 수정으로 해결했습니다.
      - **BGM 음소거 해제 오류:** BGM을 껐다가 다시 켰을 때 음악이 재생되지 않던 문제를 `pause()`/`unpause()`를 사용하도록 `audio_manager.py`를 수정하여 해결했습니다.

- **결과:**
  - 게임의 모든 핵심 상호작용에 효과음이 연동되었고, 데이터에 기반한 동적 사운드 시스템과 사운드 제어 기능까지 구현하여 **Phase 4.6**의 목표를 성공적으로 완수했습니다.
  - 개발 과정에서 발견된 다수의 데이터 불일치 및 로직 오류를 수정하여 시스템 전반의 안정성과 완성도를 크게 향상시켰습니다.

### 2025-12-01 (Ver 4.5)
- **To:** DGFS PM
- **작업 목표:** 게임의 분위기와 몰입도를 높이기 위한 배경 음악(BGM) 시스템 구현 및 적용 (Phase 4.5)
- **주요 변경사항:**
  1.  **[New] `AudioManager` 고도화 (`ui/audio_manager.py`):**
      - **내용:** BGM의 스트리밍 재생을 전담하는 `play_bgm` 메소드를 구현했습니다. 이 메소드는 중복 재생 방지, 크로스페이드(2초), 무한 루프, 파일 부재 시 예외 처리 등 안정적인 BGM 재생을 위한 모든 고급 기능을 포함합니다.
      - **기대효과:** 씬 전환이나 상황 변경 시 BGM이 끊김 없이 부드럽게 전환되어, 플레이어의 몰입감을 유지하고 게임의 전체적인 완성도를 높입니다.

  2.  **[New] 다이내믹 BGM 시스템 구현 (`game_systems/stage_manager.py`):**
      - **내용:** 현재 층과 바이옴(테마)에 따라 적절한 BGM 파일명을 반환하는 `get_current_bgm_name` 메소드를 구현했습니다. 층별 티어(1~30층: t1, 31~60층: t2 등)와 테마(Mario, Pokemon 등)를 조합하여 `bgm_mario_t1.mp3` 와 같은 동적인 파일명을 생성합니다.
      - **기대효과:** 플레이어가 등반하는 층과 테마에 따라 배경 음악이 자동으로 변경되어, 게임의 분위기가 다채로워지고 탐험의 재미가 강화됩니다.

  3.  **[Update] 모든 `Scene`에 BGM 시스템 연동:**
      - **비전투 씬 (`Lobby`, `Gacha`, `Deck`, `Coupon`):** 각 씬에 진입(`enter` 메소드)할 때, `AudioManager`를 호출하여 공통 로비 BGM(`bgm_lobby.mp3`)을 재생하도록 통일했습니다. 이를 통해 메뉴 화면 간 이동 시 일관된 분위기를 제공합니다.
      - **전투 씬 (`Battle`):** 전투 시작(`setup_battle` 메소드) 시, `StageManager`에 현재 층에 맞는 BGM을 요청하고, 반환된 파일명으로 BGM을 재생하도록 구현했습니다.

- **결과:**
  - 로비부터 각 테마별 전투까지, 게임의 모든 상황에 맞는 배경 음악이 자동으로 재생되는 완전한 BGM 시스템을 구축했습니다.
  - 이를 통해 게임의 청각적 경험을 크게 향상시키고, 각 컨텐츠의 분위기와 몰입도를 극대화하여 **Phase 4.5**의 목표를 성공적으로 완수했습니다.

### 2025-12-01 (Ver 4.25)
- **To:** DGFS PM
- **작업 목표:** 이미지/사운드 등 리소스가 없는 상태에서도 게임이 정상 작동하도록 시스템 프레임워크 선행 개발 (Phase 4.25)
- **주요 변경사항:**
  1.  **[New] 오디오 시스템 Placeholder 구현 (`ui/audio_manager.py`):**
      - **내용:** BGM/SFX 재생을 담당하는 `AudioManager`를 구현했습니다. 사운드 파일이 존재하지 않을 경우, 오류를 발생시키지 않고 콘솔에 로그만 남기고 정상적으로 진행되도록 예외 처리 로직을 추가했습니다.
      - **기대효과:** 사운드 리소스가 준비되지 않은 상태에서도 게임의 핵심 로직을 테스트할 수 있습니다.

  2.  **[New] VFX 시스템 Placeholder 구현 (`ui/vfx.py`, `ui/battle_view.py`):**
      - **내용:** 기존 `FloatingTextManager`를 모든 시각 효과를 관리하는 `VFXManager`로 확장했습니다. 실제 이펙트 이미지가 없을 때를 대비하여, 피격 위치에 '빨간색 사각형'이 잠시 나타났다 사라지는 `HitEffect`를 Placeholder로 구현하고 전투 로직과 연동했습니다.
      - **기대효과:** 실제 VFX 리소스 없이도 공격/피격에 대한 시각적 피드백을 즉시 확인할 수 있습니다.

  3.  **[Refactor] 이미지 로딩 시스템 방어 로직 추가 (`ui/components.py`, `scenes/gacha_scene.py`):**
      - **내용:** `CharacterCard`와 소환 결과 화면에서 캐릭터 이미지를 불러올 때, 파일이 없으면 '회색 사각형'과 '캐릭터 이름'이 대신 표시되도록 방어적으로 코드를 수정했습니다.
      - **기대효과:** 캐릭터 이미지가 누락되어도 UI가 깨지거나 프로그램이 종료되지 않으며, 어떤 캐릭터인지 명확히 인지할 수 있습니다.

  4.  **[Bug Fix] 리팩토링 과정에서 발생한 연관 오류 수정:**
      - `scenes/gacha_scene.py`: 버튼 이벤트 처리 로직 오류로 10회 소환, 뒤로가기 버튼이 동작하지 않던 문제를 수정했습니다.
      - `scenes/battle_scene.py`: `VFXManager`로의 이름 변경이 일부 반영되지 않아 '이어하기', '새로하기' 시 게임이 멈추거나 로비로 돌아오던 문제를 해결했습니다.

- **결과:**
  - 오디오, VFX, 이미지 등 핵심 시각/청각 리소스가 없는 개발 초기 단계에서도 게임의 주요 기능들이 안정적으로 구동될 수 있는 견고한 기반을 마련했습니다.
  - 이를 통해 향후 리소스가 추가될 때, 로직 변경 없이 간단히 연동만 하면 되도록 시스템의 확장성을 확보했습니다.

### 2025-12-01 (Ver 4.23)
- **To:** DGFS PM
- **작업 목표:** 등반 시스템 핵심 버그 수정 및 데이터 정합성 확보
- **주요 변경사항:**
  1.  **[Bug Fix] 등반 시작 시 레벨 표시 오류 수정:**
      - **문제점:** '새로 하기'로 등반을 시작할 때, 영구적으로 성장한 캐릭터의 레벨이 1로 표시되는 버그가 있었습니다. 능력치는 올바르게 적용되었으나, 표시되는 레벨만 초기화되었습니다.
      - **해결책:** `scenes/battle_scene.py`에서 전투 데이터를 생성할 때, DB에서 불러온 캐릭터의 영구 레벨(`data["level"]`)이 `FighterData` 객체에 정확히 전달되도록 수정했습니다.

  2.  **[Bug Fix] 임시 성장 능력치 영구 누적 오류 수정:**
      - **문제점:** 등반 중 보상으로 얻은 임시 능력치(최대 체력, 공격력 등)가 등반 종료 후에도 영구적으로 캐릭터 스탯에 누적되는 치명적인 버그가 있었습니다.
      - **해결책:** `game_systems/battle_data_handler.py`의 `save_run_state` 함수를 수정했습니다. 이제 등반 상태 저장 시 '현재 HP/MP/SP'만 저장하고, 영구 스탯(`total_max_hp`, `total_atk` 등)은 업데이트하지 않도록 변경했습니다.

  3.  **[Finalize] 등반 시스템 기능 안정화 검토:**
      - 앞선 버그 수정을 포함하여, 등반 시스템의 3대 핵심 기능(영구 데이터 로드, 세션 데이터 유지, 자유로운 캐릭터 행동 선택)이 기획 의도대로 모두 정상 동작함을 최종 확인했습니다.

- **결과:**
  - 게임의 핵심 콘텐츠인 '등반' 과정에서 발생하던 데이터 불일치 문제를 해결하여, 플레이어가 의도된 성장 경험을 할 수 있도록 시스템을 안정화했습니다.
  - 영구 성장과 임시 성장의 경계를 명확히 하여, 로그라이크의 '도전'과 RPG의 '육성'이라는 이중 성장 시스템의 컨셉을 강화했습니다.

### 2025-11-30 (Ver 4.22)
- **To:** DGFS PM
- **작업 목표:** 코드 분석 및 산출물 업데이트 (Phase 4.22)
- **주요 변경사항:**
  1.  **[Doc] `Code_structure_v4.21.txt` 분석 및 확인:**
      - 현재 코드 베이스와 `Code_structure_v4.21.txt`의 내용이 일치함을 확인했습니다. 문서 버전은 내부적으로 `4.22`로 되어 있어 추가 수정은 진행하지 않았습니다.
  2.  **[Doc] `Definition_v4.21.txt` 버전 통일 및 상태 업데이트:**
      - 사용자 요청에 따라 문서 버전을 `4.23`에서 `4.22`로 수정하여 버전 통일성을 확보했습니다.
      - 개발 로드맵의 `Phase 4.22` 상태를 `[In Progress]`로, `Phase 4.23`을 `[TBD]`로 수정하여 현재 진행 상황을 명확히 반영했습니다.
  3.  **[Doc] `dev_log.md` 업데이트:**
      - 코드 분석 및 문서 현행화 작업에 대한 로그를 추가하여 작업 이력을 기록했습니다.

- **결과:**
  - 프로젝트의 모든 산출물이 `Ver 4.22` 기준으로 정렬되었으며, 현재 코드 상태와 문서 간의 정합성이 확보되었습니다.
  - 다음 단계 개발을 위한 명확한 기준점을 마련했습니다.

### 2025-11-30 (Ver 4.22)
- **To:** DGFS PM
- **작업 목표:** 핵심 기획/설계 문서와 현재 코드베이스의 정합성 확보 (Phase 4.22)
- **주요 변경사항:**
  1.  **[Doc] `Definition.txt` 대규모 현행화:**
      - **규칙 명문화:** 기획 메모에만 존재하던 '사망 패널티/부활', '전투 보상 선택' 등 핵심 로그라이크 규칙을 공식 게임 규칙(5. 상세 게임 규칙)에 모두 명시했습니다.
      - **부정확한 정보 수정:** 현재 코드와 맞지 않던 '전투 패널'의 UI 구조 설명을 '3분할 레이아웃'으로 수정하는 등 문서 전반의 오류를 바로잡았습니다.
      - **기획 컨셉 정렬:** 논의를 통해 '오토 배틀'과 같은 과거 기획을 공식적으로 제외하고, 현재 개발 방향성에 맞는 핵심 컨셉을 명확히 재정의했습니다.

  2.  **[Doc] `Code_structure.txt` 최신화:**
      - `coupon.py`, `stage_manager.py`, `battle_view.py` 등 그동안 문서에 누락되었던 모든 코드 파일의 역할과 구조를 분석하여 추가했습니다.
      - 이를 통해 코드 베이스 전체의 구조를 파악할 수 있는 최신 아키텍처 문서를 확보했습니다.

- **결과:**
  - 프로젝트의 두 핵심 산출물인 **기획 정의서(`Definition`)**와 **코드 구조 분석서(`Code_structure`)**가 현재 상태를 100% 반영하도록 업데이트되었습니다.
  - 이로써 PM과 개발자(AI) 간의 오해 소지를 없애고, 향후 유지보수 및 기능 추가를 위한 명확하고 신뢰도 높은 기반을 마련했습니다.

### 2025-11-30 (Ver 4.21.2)
- **To:** DGFS PM
- **작업 목표:** 주요 게임 플레이 버그 수정 및 보상 시스템 UX 개선 
- **주요 변경사항:**
  1.  **[Bug Fix] 등반/전투 관련 주요 버그 수정:**
      - **레벨 미적용:** 새로운 등반 시, 영구 레벨이 적용되지 않는 문제.
      - **경험치 누락:** 특정 조건에서 전투 승리 후 경험치를 획득하지 못하는 문제.
      - **보상 미반영:** 층 클리어 보상(스탯 상승 등)이 다음 층에 적용되지 않는 문제.
      - **캐릭터 비정상 부활:** 사망한 캐릭터가 다음 층에서 살아나는 문제.
      - **타겟팅 불가:** 플레이어 턴에 공격할 캐릭터를 수동으로 선택할 수 없는 문제.
  2.  **[UX] 보상 선택 프로세스 개선:**
      - **기존:** 보상 클릭 시 즉시 능력치 적용.
      - **변경:** 보상 클릭 시 '선택' 상태로만 표시하고, '다음 층으로' 또는 '저장 후 종료' 버튼을 눌렀을 때 최종적으로 적용되도록 변경. 이를 통해 사용자의 선택 실수를 방지하고 결정 과정을 개선.
  3.  **[Doc] 산출물 버전 통일:**
      - `Definition`, `Code_structure` 등 핵심 기획/설계 문서의 버전을 `4.23`으로 갱신하고, 금번 변경사항을 모두 반영할 예정.

- **기대 효과:**
  - 게임의 핵심 루프인 '전투-보상-성장' 과정에서 발생하던 치명적인 오류들을 해결하여 플레이 경험의 완결성을 높입니다.
  - 보상 선택 UX를 개선하여 사용자의 편의성과 전략적 선택의 여지를 제공합니다.

### 2025-11-29 (Ver 4.21.1)
- **To:** DGFS PM
- **작업 목표:** Phase 4.21 UI Hotfix 최종 안정화 및 개발 범위 완료 보고
- **주요 변경사항:**
  1.  **[Finalize] '내 덱 보기' UI 최종 안정화:**
      - **정렬 기준 명확화:** 캐릭터 등급(Grade)을 기준으로 내림차순 정렬을 최종 적용하고, 동일 등급 내에서는 기본 순서를 따르도록 안정화했습니다.
      - **카드 디자인 통일:** 요청에 따라 캐릭터 카드 배경색을 회색으로 통일하고, 이미지 박스와의 시각적 계층 구조를 명확히 했습니다.
      - **핵심 버그 수정 완료:** 폰트, 색상, 레이아웃 관련 잔여 이슈를 모두 해결하고 `TypeError` 발생 가능성을 원천 차단하여 안정성을 확보했습니다.

  2.  **[Finalize] 전투 패널(Battle Panel) 레이아웃 완성:**
      - **좌/우 분할 구조 최종 적용:** 아군 정보 표시를 좌/우 2열 구조로 확정하여, 상하 분할 시 발생하던 모든 UI 겹침 및 가독성 저하 문제를 해결했습니다.
      - **개별 경험치 바 적용:** 각 캐릭터 슬롯 하단에 HP/MP/SP와 동일한 크기의 개별 경험치 바를 추가하여, 캐릭터별 성장 상태를 전투 중에도 명확히 인지할 수 있도록 개선했습니다.

- **결과:**
  - 이번 개발 범위였던 **Phase 4.21 (UI Visualization)**의 모든 요구사항이 성공적으로 구현 및 안정화되었습니다.
  - '내 덱 보기'와 '전투' 화면의 UX가 기획 의도에 맞게 완성되었음을 보고합니다.
  - 다음 단계 진행을 위한 코드 동결 및 검토 준비를 완료했습니다.

### 2025-11-29 (Ver 4.21 Hotfix)
- **To:** DGFS PM
- **작업 목표:** 주요 UI(덱 보기, 전투 패널)의 시인성 및 사용성 개선을 위한 긴급 수정 (Phase 4.21 UI Hotfix)
- **주요 변경사항:**
  1.  **[Fix] '내 덱 보기' UI 기능 및 시각 오류 수정:**
      - **한글 폰트 문제 해결:** 캐릭터 상세 정보 팝업(`ui/popup.py`)에서 한글 캐릭터명이 깨지는 현상을 수정했습니다. (원인: 기본 폰트 미지정)
      - **등급별 색상 적용:** 캐릭터 카드의 이름과 등급 텍스트에 각 등급에 맞는 색상(`GRADE_COLORS`)이 적용되도록 `ui/components.py`를 수정했습니다.
      - **정렬 로직 수정:** 등급이 높은 캐릭터가 항상 좌측 상단부터 표시되도록 `scenes/deck_scene.py`의 정렬 로직을 보강했습니다.
      - **카드 디자인 개선:** 요청에 따라 카드 배경, 테두리, 이미지 박스 디자인을 수정하여 시인성을 개선했습니다.
      - **`TypeError` 해결:** `ToggleButton` 생성자 오류로 인해 게임이 비정상 종료되던 문제를 해결했습니다.

  2.  **[Refactor] 전투 패널 아군 정보 표시 방식 전면 개편 (`ui/battle_panel.py`):**
      - **문제점:** 기존 상하(Top-down) 분할 레이아웃이 세로 공간 부족으로 정보가 겹치는 심각한 문제가 있었습니다.
      - **해결책 (좌우 분할):** 좌측 아군 패널을 가로로 2분할하여, 2명의 아군 정보를 **좌/우(Side-by-side)**로 나란히 배치하는 구조로 전면 수정했습니다.
      - **개별 경험치 바 도입:** 전투 패널 하단의 공용 경험치 바를 제거하고, 각 아군 정보 슬롯 내부에 HP/MP/SP와 동일한 스타일의 **개별 경험치 바**를 추가했습니다.
      - **레이아웃 최적화:** 이름, 게이지, 스탯, 경험치 바가 겹치지 않도록 내부 모든 요소의 간격(Padding)과 폰트 크기를 재조정하여 시인성을 확보했습니다.

- **결과:**
  - '내 덱 보기'와 '전투'라는 두 핵심 화면의 사용자 경험(UX)과 정보의 명확성이 크게 향상되었습니다.
  - 특히 전투 중 아군 전체의 상태를 한눈에 파악할 수 있게 되어, 전략적인 플레이가 가능해졌습니다.
  - Phase 4.21의 UI 시각화 목표를 성공적으로 마무리하고 안정성을 확보했습니다.

### 2025-11-29 (Ver 4.25)
- **To:** DGFS PM
- **작업 목표:** 레벨링 시스템 기획 최종 반영 및 산출물(문서) 현행화 (Phase 4.2)
- **주요 변경사항:**
  1.  **[Feature] `LevelManager` 구현 완료:** 기획서에 명시된 이중 성장(Dual Growth) 모델을 `game_systems/level_manager.py`에 코드로 최종 구현 완료했습니다.
  2.  **[Doc] `Definition_v4.2.txt` 업데이트:** PM의 기획 의도에 맞춰, '영구/임시 성장' 개념, 획득 경로, 세부 규칙(경험치 공식, 스탯 성장률)을 명확히 정의하고 문서화했습니다.
  3.  **[Doc] `Code_structure_v4.2.txt` 업데이트:** `level_manager.py`의 기술적 역할(Growth Rule Engine), 핵심 메소드, 트랜잭션 참여 원칙(`cursor`) 등을 코드 구조 분석 문서에 상세히 반영했습니다.
- **결과:**
  - 레벨링 시스템의 **기획(Definition) - 코드(Implementation) - 구조(Structure)** 간의 정합성을 모두 확보했습니다.
  - 이로써 PM께 명확하게 정리된 개발 산출물을 전달할 준비를 완료했습니다.

### 2025-11-29 (Ver 4.21)
- **To:** DGFS PM
- **작업 목표:** 레벨링 시스템(Phase 4.2)의 핵심 로직 안정화 및 연관 버그 수정
- **주요 변경사항:**
  1.  **[Architect] DB 트랜잭션 관리 구조 개선:**
      - **문제점:** 뽑기, 전투 보상 등 여러 모듈에서 각자 DB Connection을 생성하여 `database is locked` 오류 및 `TypeError`를 유발하는 것을 확인했습니다.
      - **해결책:** 최상위 책임 모듈(`gacha.py`, `battle_system.py` 등)에서 단일 DB 트랜잭션(`cursor`)을 생성하고, 이를 하위 모듈(`level_manager.py`, `database.py`)로 명시적으로 전달하는 아키텍처를 적용하여 트랜잭션의 일관성을 확보했습니다.

  2.  **[Fix] Gacha 시스템 안정화:**
      - `gacha.py`: `_save_to_inventory` 함수를 전면 개편하여, 티켓 차감, 캐릭터 저장, 경험치 부여의 모든 과정이 단일 트랜잭션 내에서 원자적으로 처리되도록 수정했습니다.
      - `gacha_scene.py`: UI 계층의 불필요한 DB 접근(`add_tickets` 호출)을 제거하고, 모든 책임을 `GachaManager`에 위임했습니다.
      - 이로써 뽑기 시 발생하던 `database is locked`, `TypeError` 및 10회 뽑기 실패, UI 지연 등의 연쇄적인 문제가 모두 해결되었습니다.

  3.  **[Fix] 전투 보상 시스템 안정화:**
      - `battle_system.py`: `process_victory` 함수가 `LevelManager` 호출 시 `cursor`를 전달하지 않아 발생하던 `TypeError`를 수정했습니다. 이제 전투 승리 후 경험치 지급 및 저장이 자체 트랜잭션 내에서 안정적으로 수행됩니다.

  4.  **[Refactor] `database.py` 및 `level_manager.py` 개선:**
      - `database.py`: `add_character_to_inventory`의 책임을 명확히 하고, 트랜잭션 재사용성을 높이기 위해 `cursor`를 사용하는 `get_character_details_by_inv_id_cursor` 함수를 추가했습니다.
      - `level_manager.py`: `gain_exp`와 `gain_exp_for_character`가 `cursor`를 인자로 받도록 수정하여, 상위 모듈의 트랜잭션에 참여할 수 있도록 구조를 개선했습니다.

- **결과:**
  - Gacha와 전투 보상, 두 핵심 성장 축에서 발생하던 치명적인 DB 관련 오류들을 모두 해결했습니다.
  - 이로써 **Phase 4.2 (Leveling System)**의 핵심 기능이 비로소 안정적으로 동작하게 되었으며, 전체 시스템의 데이터 무결성과 안정성이 크게 향상되었습니다.

### 2025-11-29 (Ver 4.12)
- **To:** DGFS PM
- **작업 목표:** 주요 UI 씬 배경 적용 및 시각적 완성도 향상 (Phase 4.1.7 UI Visual Polish)
- **주요 변경사항:**
  1.  **[Resource] UI 배경 리소스 확장:**
      - `ui/background_manager.py`에 `bg_deck.png`, `bg_shop.png`, `bg_gacha_1.png`, `bg_gacha_10.png`, `bg_coupon.png` 등 각 씬에 맞는 전용 배경 이미지를 로드하고 관리하는 기능을 추가했습니다. `get_ui_background(type)` 메서드를 통해 각 씬에서 배경을 쉽게 가져올 수 있습니다.

  2.  **[Scene] `deck_scene` 시각 개선:**
      - `bg_deck.png` 배경 이미지를 적용했습니다.
      - 화면 중앙의 캐릭터 목록 영역에 가독성 확보를 위해 Alpha 180의 검은색 반투명 오버레이를 추가했습니다.

  3.  **[Scene] `gacha_scene` 시각/UX 개선:**
      - **메인 화면:** `bg_shop.png` 배경을 적용하고, 기존의 텍스트 버튼을 제거했습니다. 대신 배경의 카펫 영역에 투명 버튼을 배치하여, 해당 영역 클릭 시 1회/10회 소환이 실행되는 Diegetic UI를 구현했습니다. 보유 티켓 정보는 우측 상단으로 이동했습니다.
      - **결과 화면:** 1회 소환 시 `bg_gacha_1.png` 배경과 함께 캐릭터가 제단 위에 표시되고, 10회 소환 시 `bg_gacha_10.png` 배경 위에 뒷줄은 축소, 앞줄은 원본 크기로 캐릭터를 배치하여 원근감을 표현하는 로직을 적용했습니다.

  4.  **[Scene] `coupon_scene` 시각 개선:**
      - `bg_coupon.png` 배경 이미지를 적용했습니다.
      - UI 요소들을 재배치하여, 쿠폰 입력창은 배경 속 '책상 위'에, 관련 버튼들은 그 근처에 위치하도록 수정했습니다.

- **결과:**
  - 주요 기능 씬(덱, 소환, 쿠폰)에서 검은색 배경을 제거하고 테마에 맞는 고유한 배경 이미지를 적용하여 게임의 시각적 몰입감과 완성도를 크게 향상시켰습니다.
  - 소환 상점에 Diegetic UI를 도입하여 사용자 경험을 더욱 풍부하게 만들었습니다.
  - **Phase 4.1.7**의 핵심 목표를 성공적으로 완수했습니다.

- **남은 이슈:**
  - `gacha_scene`과 `coupon_scene`의 '뒤로 가기' 버튼이 기획서에 명시된 위치(좌측 상단, 문 근처)로 이동되지 않고 기존 위치(우측 하단)에 남아있습니다. 다음 UI 폴리싱 단계에서 수정이 필요합니다. (현재 중요한 수정 사항 아님)

### 2025-11-29 (Ver 4.11)
- **To:** DGFS PM
- **작업 목표:** `Fighter` 클래스의 완전한 분리 (Phase 4.1.6 Advanced Refactoring)
- **주요 변경사항:**
  1.  **[Architect] `Fighter` 클래스 완전 분리 (Model-View 분리):**
      - **`game_systems/fighter_data.py` (신규):** 기존 `Fighter` 클래스에서 캐릭터의 순수 데이터(HP, ATK, AGI, 상태 등)와 관련 로직(데미지 계산 등)을 분리하여 `FighterData` 클래스를 생성했습니다. 이 클래스는 `pygame`에 전혀 의존하지 않는 순수한 Model입니다.
      - **`ui/fighter_view.py` (신규):** `FighterData`를 기반으로 캐릭터의 시각적 표현(이미지, HP 바)과 애니메이션(공격, 피격, 사망)을 전담하는 `FighterView` 클래스를 생성했습니다.
      - **`scenes/battle_scene.py` (Controller 경량화):** `Fighter` 객체를 직접 생성하고 `update`, `draw` 하던 로직을 모두 제거했습니다. 이제 `BattleScene`은 `FighterData`를 생성하고, 이를 `BattleSystem`과 `BattleView`에 전달하는 역할만 수행하여 Controller로서의 책임이 명확해졌습니다.
      - **`ui/battle_view.py` (View 책임 강화):** 이제 `FighterView` 객체 리스트를 직접 소유하고 관리하며, 이들의 `update`와 `draw`를 책임집니다.
      - **`game_systems/battle_system.py` (Model 연동):** `Fighter` 객체 대신 순수한 `FighterData` 객체를 다루도록 수정되었습니다.

  2.  **[Fix] 전투 시스템 핵심 버그 수정:**
      - **공격 순서 오류 해결:** 모든 캐릭터의 행동을 취합한 후 AGI 스탯으로 정렬하여, 민첩성이 높은 캐릭터가 항상 먼저 공격하도록 수정했습니다.
      - **전투 조기 종료 오류 해결:** 모든 캐릭터의 행동이 끝나기 전에 전투가 종료되던 심각한 버그를 수정했습니다. 이제 모든 턴이 정상적으로 처리된 후에 승/패가 판정됩니다.

- **결과:**
  - "거대한 `Fighter` 클래스"를 성공적으로 분해하여, **데이터(`FighterData`)**, **시각화(`FighterView`)**, **흐름 제어(`BattleScene`)** 의 관심사를 완벽하게 분리했습니다.
  - 이로써 "수치가 이상하면 `FighterData`", "그림이 이상하면 `FighterView`"처럼 문제의 원인을 특정하기 매우 용이해져 유지보수성이 극대화되었습니다.
  - **Phase 4.1.6**의 핵심 목표를 성공적으로 완수했습니다.

- **남은 이슈:**
  - 전투 승리 시, 사망 애니메이션(Fade out)이 재생될 시간을 확보하지 못하고 즉시 보상 화면으로 전환되는 문제가 남아있습니다. (다음 단계에서 해결 예정)

### 2025-11-28 (Ver 4.10)
- **To:** DGFS PM
- **작업 목표:** 전투 시스템 MVC 패턴 완성 및 UI 조작 계통 마우스 중심 통일
- **주요 변경사항:**
  1.  **[Architect] 전투 시스템 MVC 패턴 완성 (M-V-C 완전 분리):**
      - **`ui/battle_view.py` (신규):** 기존 `BattleScene`에 있던 모든 그리기(View) 로직과 Pygame 이벤트 처리(하위 Controller) 로직을 `BattleView`로 이전했습니다. 이제 `BattleView`는 화면 렌더링과 UI 입력의 1차 가공을 전담하는 '스마트 뷰' 역할을 수행합니다.
      - **`scenes/battle_scene.py` (Controller 역할 순수화):** `BattleView`에 UI 관련 책임을 모두 위임하고, `BattleSystem`(Model)과 `BattleView`(View) 사이의 흐름만 제어하는 순수한 '컨트롤러'로 경량화되었습니다. UI 객체(버튼, 패널 등)를 직접 관리하지 않습니다.
      - **`game_systems/battle_system.py` (Model 순수성 강화):** 마우스 좌표(`pos`)에 의존하던 `handle_mouse_click` 메서드를 제거했습니다. 대신, `BattleView`가 식별한 '객체'를 직접 받는 `select_target_and_confirm` 메서드를 도입하여 `pygame` 의존성을 완전히 제거하고 모델의 독립성을 강화했습니다.
ㅊ
  2.  **[UX/Refactor] UI 조작 계통 마우스 중심 통일:**
      - **키보드 조작 제거:** 일관된 사용자 경험을 위해 `BattleScene`, `DeckScene`, `GachaScene`에서 `ESC` 키를 포함한 모든 키보드 조작 로직을 제거했습니다.
      - **마우스 우클릭 '취소' 기능 도입:**
        - **전투 씬:** 타겟 선택 중 우클릭 시, 행동 선택 단계로 돌아갑니다.
        - **덱 씬:** 화면에서 우클릭 시, 로비로 즉시 이동합니다.
      - **`DeckScene` 편의성 개선:** '로비로 돌아가기' 버튼을 명시적으로 추가하여, 키보드 조작 부재에 따른 불편함을 해소하고 UI의 직관성을 높였습니다.
      - **안내 문구 수정:** 변경된 조작법에 맞춰 모든 관련 화면(`DeckScene`, `GachaScene`)의 하단 안내 문구를 수정했습니다.

- **결과:**
  - 전투 시스템이 **Model(`BattleSystem`) - View(`BattleView`) - Controller(`BattleScene`)** 의 MVC 패턴으로 완벽하게 분리되었습니다. 이로써 "버튼이 안 눌리면 View 문제", "로직이 틀리면 System 문제"처럼 책임 소재가 명확해져 유지보수성과 확장성이 극대화되었습니다.
  - 게임 전반의 조작 방식이 마우스 중심으로 통일되어 사용자 경험의 일관성과 직관성이 크게 향상되었습니다.
  - 이번 아키텍처 폴리싱으로 **Phase 4.1.5**의 목표를 성공적으로 완수했습니다.

### 2025-11-28 (Ver 4.10)
- **To:** DGFS PM
- **작업 목표:** 전투 시스템 MVC 패턴 완성 및 UI 조작 계통 마우스 중심 통일
- **주요 변경사항:**
  1.  **[Architect] 전투 시스템 MVC 패턴 완성 (M-V-C 완전 분리):**
      - **`ui/battle_view.py` (신규):** 기존 `BattleScene`에 있던 모든 그리기(View) 로직과 Pygame 이벤트 처리(하위 Controller) 로직을 `BattleView`로 이전했습니다. 이제 `BattleView`는 화면 렌더링과 UI 입력의 1차 가공을 전담하는 '스마트 뷰' 역할을 수행합니다.
      - **`scenes/battle_scene.py` (Controller 역할 순수화):** `BattleView`에 UI 관련 책임을 모두 위임하고, `BattleSystem`(Model)과 `BattleView`(View) 사이의 흐름만 제어하는 순수한 '컨트롤러'로 경량화되었습니다. UI 객체(버튼, 패널 등)를 직접 관리하지 않습니다.
      - **`game_systems/battle_system.py` (Model 순수성 강화):** 마우스 좌표(`pos`)에 의존하던 `handle_mouse_click` 메서드를 제거했습니다. 대신, `BattleView`가 식별한 '객체'를 직접 받는 `select_target_and_confirm` 메서드를 도입하여 `pygame` 의존성을 완전히 제거하고 모델의 독립성을 강화했습니다.

  2.  **[UX/Refactor] UI 조작 계통 마우스 중심 통일:**
      - **키보드 조작 제거:** 일관된 사용자 경험을 위해 `BattleScene`, `DeckScene`, `GachaScene`에서 `ESC` 키를 포함한 모든 키보드 조작 로직을 제거했습니다.
      - **마우스 우클릭 '취소' 기능 도입:**
        - **전투 씬:** 타겟 선택 중 우클릭 시, 행동 선택 단계로 돌아갑니다.
        - **덱 씬:** 화면에서 우클릭 시, 로비로 즉시 이동합니다.
      - **`DeckScene` 편의성 개선:** '로비로 돌아가기' 버튼을 명시적으로 추가하여, 키보드 조작 부재에 따른 불편함을 해소하고 UI의 직관성을 높였습니다.
      - **안내 문구 수정:** 변경된 조작법에 맞춰 모든 관련 화면(`DeckScene`, `GachaScene`)의 하단 안내 문구를 수정했습니다.

- **결과:**
  - 전투 시스템이 **Model(`BattleSystem`) - View(`BattleView`) - Controller(`BattleScene`)** 의 MVC 패턴으로 완벽하게 분리되었습니다. 이로써 "버튼이 안 눌리면 View 문제", "로직이 틀리면 System 문제"처럼 책임 소재가 명확해져 유지보수성과 확장성이 극대화되었습니다.
  - 게임 전반의 조작 방식이 마우스 중심으로 통일되어 사용자 경험의 일관성과 직관성이 크게 향상되었습니다.
  - 이번 아키텍처 폴리싱으로 **Phase 4.1.5**의 목표를 성공적으로 완수했습니다.

### 2025-11-28 (Ver 4.9)
- **작업 목표:** `battle_scene.py` 대규모 리팩토링 완료 및 시스템 안정화
- **주요 변경사항:**
  1.  **[Architect] 전투 시스템 3-Tier 분리 리팩토링 완료:** PM님의 제안에 따라, 약 1300줄에 달하던 거대 클래스 `BattleScene`을 아래와 같이 3개의 클래스로 역할을 분리하는 데 성공했습니다.
      - **`game_systems/battle_data_handler.py` (신규):** 데이터베이스 접근을 전담합니다. 전투 준비(`setup_battle_data`), 게임 상태 저장(`save_run_state`) 등 모든 `sqlite` 관련 코드를 이관하여 `BattleScene`의 DB 의존성을 완전히 제거했습니다.
      - **`game_systems/battle_system.py` (신규):** 순수 전투 로직을 전담합니다. `pygame`과 독립적으로 설계되었으며, 전투 상태 기계(`state`), 턴 관리(`turn_queue`), 행동/타겟팅 규칙 등 핵심 두뇌 역할을 수행합니다.
      - **`scenes/battle_scene.py` (경량화):** 이제 `View`와 `Controller`의 역할만 수행합니다. `BattleSystem`의 상태를 화면에 그리고, 사용자의 입력을 `BattleSystem`에 전달하는 가벼운 클래스로 재탄생했습니다.
  2.  **[Fix] `NotImplementedError` 해결:** 리팩토링 과정에서 `battle_scene.py`의 `draw` 메소드가 다른 메소드 내부에 잘못 들여쓰기되어 클래스 메소드로 인식되지 못하는 구조적 결함을 발견하고 수정했습니다. 이로써 '새로 하기' 선택 시 발생하던 게임 비정상 종료 문제를 해결했습니다.
  3.  **[Fix] 보상 화면 무한 루프 버그 해결:** 전투 승리 후 '다음 층으로'를 선택해도 보상 화면이 사라지지 않던 치명적인 상태 관리 버그를 해결했습니다.
      - **원인:** `BattleScene`이 매 프레임 `BattleSystem`의 상태(`VICTORY`)를 자신의 상태로 덮어써서, '다음' 버튼 클릭 시 변경된 `REWARD_APPLIED` 상태가 무시되었습니다.
      - **해결:** `BattleSystem`의 최종 상태를 `BATTLE_ENDED`로 변경하고, `BattleScene`은 이 보고를 한 번만 받아 자신의 `VICTORY` 또는 `DEFEAT` 상태를 결정하도록 로직을 수정했습니다. 이로써 두 시스템의 상태가 분리되어 안정적인 화면 전환이 가능해졌습니다.
- **결과:**
  - 코드의 복잡성이 크게 감소하고 각 모듈의 역할이 명확해져 '턴 꼬임'과 같은 복잡한 버그를 추적하고 해결하기 용이한 구조가 되었습니다.
  - 50층까지의 플레이 테스트에서 별다른 이슈 없이 안정적인 동작을 확인했습니다. 이로써 **Phase 4.1 (Manual Battle Overhaul)** 의 핵심 목표였던 전투 시스템 리팩토링을 성공적으로 마무리합니다.

### 2025-11-28 (Ver 4.8)
- **작업 목표:** `battle_scene.py` 리팩토링 및 '턴 꼬임' 버그 해결을 위한 기반 마련
- **주요 변경사항:**
  1.  **[Refactor] `BattleDataHandler` 클래스 도입:** PM님의 제안에 따라, `battle_scene.py`에 혼재되어 있던 모든 데이터베이스 관련 로직(파티 정보 로드, 적 생성, 진행 상황 저장 등)을 `game_systems/battle_data_handler.py`로 분리하고 이관했습니다. 이제 `BattleScene`은 DB에 직접 접근하지 않고 `BattleDataHandler`를 통해 데이터를 요청합니다.
  2.  **[Refactor] `BattleSystem` 클래스 도입:** 전투의 핵심 로직(상태 기계, 턴 관리, 행동 및 타겟팅, 승/패 판정)을 담당하는 `game_systems/battle_system.py`를 생성했습니다. 이 클래스는 `pygame`에 의존하지 않는 순수 파이썬 로직으로 구성되어 테스트 용이성을 확보했습니다.
  3.  **[Refactor] `BattleScene` 경량화:** `BattleScene`의 역할을 대폭 축소하여, `BattleSystem`의 상태를 화면에 그리고(`View`), 사용자의 입력을 `BattleSystem`에 전달하는(`Controller`) 역할에만 집중하도록 구조를 변경했습니다. 약 1300줄에 달하던 코드가 핵심 로직 분리로 인해 가독성과 유지보수성이 높은 구조로 개선되었습니다.
  4.  **[New] 명시적 상태 로그 추가:** `BattleSystem` 내부에 상태가 변경될 때마다 콘솔에 `[State Change] OLD_STATE -> NEW_STATE` 형식의 로그를 출력하는 기능을 추가했습니다. 이는 '턴 꼬임' 버그를 추적하고 분석하는 데 핵심적인 역할을 할 것입니다.
- **현재 상태 및 이슈:**
  - **'턴 꼬임' 버그는 아직 해결되지 않았습니다.** 이번 리팩토링은 버그를 직접 수정하기보다는, 복잡하게 얽혀있던 UI와 로직을 분리하여 문제의 원인을 체계적으로 분석하고 해결할 수 있는 **기반을 마련**하는 데 중점을 두었습니다.
- **다음 단계:**
  - 새로 추가된 상태 변경 로그를 기반으로 전투 흐름을 면밀히 분석하여, '턴 꼬임' 버그의 정확한 발생 지점과 원인을 파악하고 수정 작업을 진행할 예정입니다.

### 2025-11-28 (Ver 4.7)
- **작업 목표:** 전투 UI 패널 개편 및 시스템 안정화
- **주요 변경사항:**
  1. **[Refactor] 정보 표시 로직 일원화:** `battle_scene.py`의 `Fighter` 클래스에 있던 HUD(체력, 공격력 표시) 그리기 로직을 완전히 제거하고, `ui/battle_panel.py`로 모든 정보 표시를 일원화했습니다. 이를 통해 BattleScene은 순수 전투 로직에, BattlePanel은 UI 표시에 집중하는 **관심사 분리(SoC)** 원칙을 강화했습니다.
  2. **[Refactor] `ui/battle_panel.py` 구조 개편:** 기존의 단순 정보 표시 패널을 **3단 레이아웃**으로 전면 재설계했습니다. [좌측: 아군 2명 정보 | 중앙: 커맨드 버튼 | 우측: 적군 2명 정보] 구조를 적용하여 전투 상황을 한눈에 파악할 수 있도록 정보 접근성을 개선했습니다.
  3. **[Update] `battle_panel.py` 기능 고도화:**
     - **종합 정보 표시**: 패널에 기존의 HP, MP, SP 외에 **ATK(공격력)**와 **AGI(민첩성)** 정보를 추가하여, 아군 캐릭터의 모든 핵심 스탯을 한 곳에서 볼 수 있도록 개선했습니다.
     - **다중 캐릭터 표시**: 패널에 현재 행동/타겟 중인 캐릭터뿐만 아니라, 파티와 적 그룹 전체(최대 2명씩)의 정보를 항상 표시하도록 변경했습니다.
     - **상태 하이라이팅**: 행동 중인 아군과 타겟팅된 적의 이름에 **골드 컬러**를 적용하여 시각적으로 명확히 구분되도록 했습니다.
     - **사망자 처리**: 적이 사망해도 패널에서 사라지지 않고 HP를 0으로 표시하여 전황을 유지하도록 했습니다.
  4. **[Update] `scenes/battle_scene.py` 연동 로직 수정:** `battle_panel`의 `update_info` 메서 시그니처 변경에 맞춰, `BattleScene`에서 패널로 **캐릭터 리스트 전체**를 전달하도록 모든 호출부를 수정했습니다.
  5. **[Fix] `scenes/battle_scene.py` (IndentationError 해결):** 타겟 선택(TARGET_SELECTION) 상태에서 키보드 입력 처리 중 발생하던 들여쓰기 오류를 수정하여 프로그램 실행을 정상화했습니다. 또한, 상태 변경 시 발생할 수 있는 잠재적 런타임 오류를 방지하기 위해 방어 코드를 추가했습니다.
- **결과:** 전투 정보 표시 체계를 `BattlePanel`로 통합하고 UI를 대대적으로 개선하여 사용자 경험(UX)과 코드 구조의 명확성을 크게 향상시켰습니다. 또한, 실행 오류를 해결하고 안정성을 높여 Phase 4.1의 핵심 목표인 '수동 전투 시스템'의 완성도를 높였습니다.

### 2025-11-28 (Ver 4.6)
- **작업 목표:** Phase 4.0: 전투 HUD 및 시각 효과(VFX) 구현
- **주요 변경사항:**
  1. **[New] `ui/vfx.py` 생성:** 전투 중 발생하는 시각 효과를 전문적으로 관리하는 모듈을 신설했습니다. 화면에 떠 다니는 텍스트(`FloatingText`)와 이를 제어하는 `FloatingTextManager`를 구현하여 데미지, 회복량 등을 표시하는 시스템의 기반을 마련했습니다.
  2. **[Update] `scenes/battle_scene.py` (HUD 구현):** `Fighter` 클래스를 수정하여 각 캐릭터의 발밑에 현재 체력(HP)과 공격력(ATK)을 표시하는 HUD를 추가했습니다. 이를 통해 플레이어는 전투 상황을 더 직관적으로 파악할 수 있습니다.
  3. **[Refactor] `scenes/battle_scene.py` (VFX 연동):** 기존의 단순 텍스트 효과를 `FloatingTextManager` 기반의 동적 시스템으로 전면 교체했습니다. 전투 중 발생하는 모든 **데미지**, **스킬 사용**, **보상 획득(회복, 스탯 상승)** 이벤트에 맞춰 시각적 피드백(플로팅 텍스트)가 표시되도록 연동했습니다.
  4. **[Fix] `scenes/battle_scene.py` (보상 연출 버그 수정):** 보상 획득 텍스트가 즉시 사라지는 문제를 해결했습니다. 보상 적용 후 다음 층으로 넘어가기 전에 잠시 대기하는 새로운 상태(`REWARD_APPLIED`)를 추가하여, 모든 시각 효과가 충분히 표시될 시간을 확보했습니다.
  5. **[Fix] `ui/vfx.py` (한글 폰트 깨짐 수정):** '뽑기 쿠폰'과 같은 한글 플로팅 텍스트가 네모(□)로 표시되던 문제를 수정했습니다. 기본 폰트를 한글 지원 폰트('맑은 고딕')로 변경하여 모든 텍스트가 정상적으로 렌더링되도록 했습니다.
- **결과:** 전투의 핵심 정보(HUD)와 동적인 시각 효과(VFX)를 성공적으로 구현하여 게임의 시각적 완성도와 플레이어 경험을 크게 향상시켰습니다. 또한, 향후 확장이 용이한 모듈식 VFX 시스템을 구축하고, 연출과 관련된 주요 버그들을 해결하여 보다 안정적이고 직관적인 게임 플레이를 제공하게 되었습니다.

### 2025-11-28 (Ver 4.5)
- **작업 목표:** 쿠폰 입력 기능의 모듈화 및 안정화
- **주요 변경사항:**
  1.  **[New] `scenes/coupon_scene.py` 생성:** 쿠폰 입력 전용 UI 및 관련 로직을 처리하는 독립된 `CouponScene` 클래스를 구현했습니다. 이를 통해 쿠폰 기능이 다른 화면과 분리되어 관리됩니다.
  2.  **[Refactor] `main.py` 구조 개선:** 메인 루프에 분산되어 있던 쿠폰 관련 코드를 모두 제거하고, `CouponScene`을 호출하여 화면을 전환하는 방식으로 로직을 단순화했습니다.
  3.  **[Update] `scenes/lobby_scene.py` 연결:** 로비 화면의 '쿠폰입력' 버튼이 `CouponScene`으로 정확하게 전환되도록 이벤트 핸들러를 수정했습니다.
  4.  **[Fix] 연속적인 오류 수정:**
     - `ImportError`: `coupon.py` 파일에 `validate_coupon` 함수가 없어 발생하는 오류를 해결했습니다.
     - `TypeError`: `Button` 컴포넌트 생성 시 필수 인자가 누락된 문제를 수정했습니다.
     - `AttributeError`: `config.py` 파일에 색상 정의(`WHITE_COLOR`)가 없어 발생하는 오류를 해결했습니다.
     - 이를 통해 프로그램의 안정성을 확보했습니다.
- **결과:** 쿠폰 기능의 완전한 독립(Decoupling)을 달성했으며, 여러 단계의 오류 수정을 통해 안정적인 실행 환경을 구축했습니다. 향후 기능 확장 및 유지보수가 용이해졌습니다.
